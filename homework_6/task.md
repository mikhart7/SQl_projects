Записки Вито Феллини, младшего сына легендарного Бернарду Феллини - самого успешного Сицилийского карабинера

-- 12 мая 1921 год. Вчера вечером я вернулся с Мальты - погодка в порту была так себе. И без того мрачное настроение усугубила мысль о том, что все нужно начинать сначала... И кто бы мог подумать, что пинкертоны так пекутся о своей территории.

-- 14 мая 1921 год. Наконец-то оклемался. Пора браться за работу. Однако моя слава меня обгоняет - абсолютно никто на Сицилии не хочет иметь дело с неудачником, вернувшимся из Америки. Марио предлагал работу в его бухгалтерии - но я скорее съем свой ботинок, чем буду работать на своего болвана-братца.

Задание 1 (10%)
-- 27 мая 1921 год. Сегодня мой первый рабочий день у Марио. Ситуация мне все еще не нравятся, но условия тут сносные. И обязанностей немного. Для начала Марио попросил найти лажу в расчетах, оставленную Фабио. У Фабио была одна цель - взять кучу чисел и перемножить. А теперь это моя задача. Grazie Dio, мне нужны только последние 3 цифры для выявления ошибки.

Задание: составить запрос, который по таблице

create table nums (
  id serial,
  num int
)
выведет последние 3 цифры произведения всех чисел.

Задание 2 (20%)
-- 12 июня 1921 год. Я уже 2 недели работаю на Марио. Организация своего дела идет, прямо скажем, не очень. К счастью сегодня меня повысили - теперь я не помогаю на его складе, я им управляю. Но есть и неприятная новость - merda, Марио уже требует отчет. Все что он мне дал - список поступлений и увозов со склада. Там есть данные о месяце, дне и количестве поступившего/уехавшего товара. От меня он требует информацию, сколько товара было в начале каждого месяца, сколько пришло/ушло, и сколько было в конце месяца. И как мне это считать...

Задание: Написать скрипт, который по таблице

create table factory(
 month int,
 day int,
 amount int
);
посчитает, сколько товара было в начале каждого месяца, сколько было в конце, и сколько товара поступило/ушло.

Задание 3 (30%)
-- 1 сентября 1921 год. Работа идет хорошо, у меня даже пропадает желание открывать свое дело. Марио доверил мне управление складом, а значит я теперь почти так же хорош, как и был до отъезда в Америку. Родственники это тоже заметили. К слову, через пару дней мы идем на день рождения к моему кузену Франчелло. Хоть бы все прошло гладко...

-- 9 сентября 1921 год. Сейчас 6 часов утра. Все прошло довольно хорошо, мы с Райаном, Ливией, Феликсом, Вулканом и Вайверн неплохо так тяпнули. Даже не знаю, кто по итогу из них адекватнее. Учитывая, что мы пили и вино и ром, причем каждый пил независимо от других, это непростой вопрос. А если учесть, что каждый час они немного трезвели - этот вопрос даже интересный. Благо я записывал, кто, что и когда пил. Быть может, потом задамся этим вопросом снова...

Задание: Написать скрипт, который по таблице

create table customer(
 id int Primary Key,
 name text
);

insert into customer values
(1, 'Ryan'), (2, 'Livia'), (3, 'Felix'), (4, 'Vulcan'), (5, 'Wyvern');

create table drinks(
 id int Primary Key,
 name text
);

insert into drinks values
(1, 'Wine'), (2, 'Rum');

create table bar(
 customer int references customer,
 drinks int references drinks,
 date timestamp
);
выведет отсортированный топ-5 по шкале неадекватности ребят к 6:00. Учитывайте следующее:

друзья начали отмечать в 21:00
выпитый стакан вина даёт +1 к нетрезвости
выпитый стакан рома даёт +2 к нетрезвости
каждый час (в 22:00, 23:00, и т.д.) каждый из друзей трезвеет и теряет 1 от нетрезвости
нетрезвость не может быть отрицательной
Задание 4 (40%)
-- 23 августа 1921 год. Я все чаще смотрю на Padre, кажется годы берут свое. И сегодня он сказал, что наша семейная фабрика - дело, которое начал еще мой далекий дед (на самом деле он прадед, но я не помню насколько пра) Пауло, должно перейти ко мне. Ничто бы не омрачило это день, если бы не весточка о том, что у меня есть далекий брат, а значит дело может перейти к нему. Я не могу это оставить так просто. Из поколения в поколение у мужчин нашей семьи был лишь один сын, по крайней мере мне так говорили. А теперь оказывается, что у какого-то моего деда было их два. Я зол. Я должен узнать, кто этот человек, и есть ли он вообще.

Задание: Написать скрипт, который по таблице

create table Italians(
 id int primary key,
 name text,
 gender text,
 parent int references Italians
);
выведет имя этого далекого брата или скажет, что его нет.

Учитывайте следующее:

У всех мужчин в семье Феллини был только 1 сын, кроме, быть может, одного.
Соответственно, если у кого-то их было два, то у каждой внука второго сына есть только один правнук. Таким образом, если искомый в задаче родственник существует, то он только один.
